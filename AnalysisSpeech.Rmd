---
title: "Analysis Speech"
author: "Tom Offrede"
date: "2022-09-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(tidyverse)
library(lme4)

`%!in%` <- Negate(`%in%`)

folder <- "C:/Users/offredet/Documents/1HU/ExperimentEyes/Data/All/"
files <- list.files(folder, "RData")
fileConv <- files[grepl("Conversation", files)]
fileBase <- files[grepl("Baseline", files)]

load(paste0(folder, fileConv))
load(paste0(folder, fileBase))

dac <- dac %>%
  mutate_at(c("turnDur", "turn", "f0mean", "prevf0", "gapDur"), as.numeric) %>%
  mutate_at(c("speaker", "condition", "Order", "task"), as.factor)

dab <- dab %>%
  mutate_at(c("condition"), as.factor)
```

## Conditions:
### GA: Gaze Aversion; the robot produced gaze aversion. Experimental condition.
### NG: No Gaze aversion; the robot stared constantly at the human. Control condition.

# Gap Duration

```{r}
ggplot(dac, aes(condition, gapDur))+
  geom_boxplot()
```


The model `gap duration ~ condition` is slightly better than the one that includes `order` (the order of conditions in each participant, i.e. if it was GA or NG first).

But still, **no effect of condition on the duration of between-turn gaps**.

```{r}
summary(g1 <- lmer(gapDur ~ condition + (1 + condition | speaker), dac))
```

# Turn Duration

```{r}
ggplot(dac %>% filter(!grepl("Robot", speaker)), aes(condition, turnDur))+
  geom_boxplot()
```

The model with `order` isn't better than the one without.

Turns are slightly longer during GA condition, but |t| is only around 1.

```{r}
summary(t1 <- lmer(turnDur ~ condition + (1 + condition | speaker), dac %>% filter(!grepl("Robot", speaker))))
```

# f0

```{r}
ggplot(dac, aes(prevf0, f0mean))+
  geom_point()+
  facet_wrap(~condition)

ggplot(dac, aes(turn, f0mean))+
  geom_point()+
  facet_wrap(~condition)
```


Again, `order` doesn't improve the model.

There doesn't seem to be an effect on f0 of interlocutor's previous turn's f0 or of its interaction with condition.
The model only with `prevf0` and without condition also doesn't give a significant effect.

The `turn` effect suggests that people speak with lower f0 the further into the conversation, but there are also considerably fewer data points the further into the conversation (see graph above), so that could be the reason for this apparent effect.

```{r}
summary(f1 <- lmer(f0mean ~ (prevf0 + condition + turn)^2 + (1 | speaker), dac %>% filter(!grepl("Robot", speaker))))
```

# f0 during baseline

```{r}
ggplot(dab, aes(prevf0, f0mean))+
  geom_point()+
  facet_wrap(~condition)
```

The results from this regression model would suggest that people's f0 during their second baseline were predicted by the f0 of the robots they interacted with in the previous conversation. But the other regression model futher below also suggests the same thing happens, except that that second model is based on f0 data from a robot that the participant hadn't interacted with yet.

Overall, I think this just means that the robots' and the humans' f0 are somehow close, but it doesn't mean the human converged to the robot.

```{r}
dab$condition <- relevel(dab$condition, ref="GA")
summary(fb1 <- lm(f0mean ~ prevf0 * condition, dab))
```
```{r}
ggplot(dab, aes(prevf0Mock, f0mean))+
  geom_point()+
  facet_wrap(~condition)
```


```{r}
summary(fbM <- lm(f0mean ~ prevf0Mock * condition, dab))
```


















